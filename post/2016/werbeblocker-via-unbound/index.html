<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Werbeblocker via unbound - </title><meta name=description content="Ich betreibe seit längerem auf einem ansonsten ungenutzten Raspberry Pi meinen eigenen DNS-Resolver.
Auf dem Raspberry Pi läuft dabei Arch Linux und unbound als DNS Resolver. Natürlich könnte man
auch einen anderen Resolver, bspw. von Google oder dem Telco nehmen, aber auf der einen Seite läuft man dann
Gefahr, dass alle DNS-Anfragen getrackt werden, Antworten manipuliert werden oder man sogar auf unerwünschte
Werbeseiten umgeleitet wird (die Telekom hat das mal gemacht und macht es schätzungsweise immer noch)."><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"edermi\u0027s Blog","url":"https:\/\/edermi.github.io\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/edermi.github.io\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/edermi.github.io\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/edermi.github.io\/post\/2016\/werbeblocker-via-unbound\/","name":"Werbeblocker via unbound"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":""},"headline":"Werbeblocker via unbound","description":"Ich betreibe seit längerem auf einem ansonsten ungenutzten Raspberry Pi meinen eigenen DNS-Resolver. Auf dem Raspberry Pi läuft dabei Arch Linux und unbound als DNS Resolver. Natürlich könnte man auch einen anderen Resolver, bspw. von Google oder dem Telco nehmen, aber auf der einen Seite läuft man dann Gefahr, dass alle DNS-Anfragen getrackt werden, Antworten manipuliert werden oder man sogar auf unerwünschte Werbeseiten umgeleitet wird (die Telekom hat das mal gemacht und macht es schätzungsweise immer noch).\n","inLanguage":"en","wordCount":659,"datePublished":"2016-03-01T00:00:00\u002b00:00","dateModified":"2024-09-09T17:51:10\u002b02:00","image":"https:\/\/edermi.github.io\/","keywords":["Werbung, unbound, DNS"],"mainEntityOfPage":"https:\/\/edermi.github.io\/post\/2016\/werbeblocker-via-unbound\/","publisher":{"@type":"Organization","name":"https:\/\/edermi.github.io\/","logo":{"@type":"ImageObject","url":"https:\/\/edermi.github.io\/","height":60,"width":60}}}</script><meta property="og:title" content="Werbeblocker via unbound"><meta property="og:description" content="Ich betreibe seit längerem auf einem ansonsten ungenutzten Raspberry Pi meinen eigenen DNS-Resolver.
Auf dem Raspberry Pi läuft dabei Arch Linux und unbound als DNS Resolver. Natürlich könnte man
auch einen anderen Resolver, bspw. von Google oder dem Telco nehmen, aber auf der einen Seite läuft man dann
Gefahr, dass alle DNS-Anfragen getrackt werden, Antworten manipuliert werden oder man sogar auf unerwünschte
Werbeseiten umgeleitet wird (die Telekom hat das mal gemacht und macht es schätzungsweise immer noch)."><meta property="og:url" content="https://edermi.github.io/post/2016/werbeblocker-via-unbound/"><meta property="og:type" content="website"><meta property="og:site_name" content="edermi's Blog"><meta name=twitter:title content="Werbeblocker via unbound"><meta name=twitter:description content="Ich betreibe seit längerem auf einem ansonsten ungenutzten Raspberry Pi meinen eigenen DNS-Resolver.
Auf dem Raspberry Pi läuft dabei Arch Linux und unbound als DNS Resolver. Natürlich könnte man
auch …"><meta name=twitter:card content="summary_large_image"><meta name=generator content="Hugo 0.134.1"><link rel=alternate href=https://edermi.github.io/index.xml type=application/rss+xml title="edermi's Blog"><link rel=stylesheet href=https://edermi.github.io/css/katex.min.css><link rel=stylesheet href=https://edermi.github.io/fontawesome/css/all.css><link rel=stylesheet href=https://edermi.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://edermi.github.io/css/main.css><link rel=stylesheet href=https://edermi.github.io/css/fonts.css><link rel=stylesheet href=https://edermi.github.io/css/syntax.css><link rel=stylesheet href=https://edermi.github.io/css/codeblock.css><link rel=stylesheet href=https://edermi.github.io/css/photoswipe.min.css><link rel=stylesheet href=https://edermi.github.io/css/photoswipe.default-skin.min.css></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://edermi.github.io/>edermi's Blog</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=About href=/about/>About</a></li><li><a title=Turingcomplete href=/turingcomplete/>Turingcomplete</a></li></ul></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Werbeblocker via unbound</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on 2016-03-01
&nbsp;(Last modified on 2024-09-09)
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;4&nbsp;minutes
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;659&nbsp;words</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p>Ich betreibe seit längerem auf einem ansonsten ungenutzten Raspberry Pi meinen eigenen DNS-Resolver.
Auf dem Raspberry Pi läuft dabei Arch Linux und unbound als DNS Resolver. Natürlich könnte man
auch einen anderen Resolver, bspw. von Google oder dem Telco nehmen, aber auf der einen Seite läuft man dann
Gefahr, dass alle DNS-Anfragen getrackt werden, Antworten manipuliert werden oder man sogar auf unerwünschte
Werbeseiten umgeleitet wird (die Telekom hat das mal gemacht und macht es schätzungsweise immer noch).</p><p>Der lokale Resolver ist also erst einmal Privatsphärenschutz. Lokales Caching erhöht zudem Zugriffszeiten
bei häufig besuchten Websites. Durch aktiviertes DNSSEC werden DNS-Antworten soweit wie möglich
kryptographisch verifiziert. Über den Sinn und Unsinn von DNSSEC kann man gerne streiten,
aber pragmatisch gesehen ist es mit Abstand das Beste was man heute schon nutzen kann. Wie man sowas aufsetzt
findet man problemlos im Netz. Worum es heute gehen soll: Werbung mittels unbound im kompletten Heimnetz
blocken.</p><h2 id=setup>Setup</h2><p>Dazu werden folgende Pakete benötigt:</p><ul><li>unbound (klar)</li><li>perl (sollte standardmäßig da sein)</li><li>perl-libwww (sollte so oder so ähnlich in den Paketquellen liegen, falls noch nicht installiert)</li><li>git (optional)</li><li>systemd timers / cron (/ whatever für reguläre updates, idR schon da)</li></ul><p>Dass man perl für die Geschichte braucht bereitet mir auch ein wenig Bauchschmerzen, da könnte man sich mal
eine Alternative schreiben. Wer da etwas hat, bitte melden!</p><p>Um nun Werbung schon an der Wurzel zu blocken, holt man sich von Github
<a href=https://github.com/jodrell/unbound-block-hosts>unbound-block-hosts</a> welches die Hosts-Datei von
<a href=http://someonewhocares.org/>Dan Pollock</a> runter lädt, in ein für unbound verständliches Format konvertiert
und speichert. Auf Github findet sich eine Dokumentation der verfügbaren Kommandozeilenparameter, ich fand
die defaults sinnvoll und habe daher lediglich das Skript <code>unbound-block-hosts</code> aufgerufen. Obwohl es bei
Github anders beschrieben ist speichert das Skript die Blockierliste direkt nach
<code>/etc/unbound/local-blocking-data.conf</code>.</p><p>Anschließend muss nur noch die unbound-Konfiguration um folgende Zeile in der <code>server</code>-Sektion erweitert
werden:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>include: /etc/unbound/local-blocking-data.conf
</span></span></code></pre></div><p>Nachdem man unbound neu gestartet hat, sollten DNS-Anfragen bezüglich Werbedomains ins Leere laufen!</p><h2 id=liste-aktuell-halten>Liste aktuell halten</h2><p>Ich habe mir dafür einen systemd-timer geschrieben, Leute die lieber cronjobs/runwhen/whatever verwenden
schaffen das in der Regel selbst.</p><p>Die <code>/etc/systemd/system/block-hosts.timer</code> sieht folgendermaßen aus:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Unit]</span>
</span></span><span class=line><span class=cl><span class=na>Description</span><span class=o>=</span><span class=s>Run unbound-block-hosts weekly and on boot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Timer]</span>
</span></span><span class=line><span class=cl><span class=na>OnBootSec</span><span class=o>=</span><span class=s>15min</span>
</span></span><span class=line><span class=cl><span class=na>OnUnitActiveSec</span><span class=o>=</span><span class=s>1w </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Install]</span>
</span></span><span class=line><span class=cl><span class=na>WantedBy</span><span class=o>=</span><span class=s>timers.target</span>
</span></span></code></pre></div><p>Der dazugehörige Service <code>/etc/systemd/system/block-hosts.service</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Unit]</span>
</span></span><span class=line><span class=cl><span class=na>Description</span><span class=o>=</span><span class=s>execute unbound-block-hosts</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Service]</span>
</span></span><span class=line><span class=cl><span class=na>Type</span><span class=o>=</span><span class=s>oneshot</span>
</span></span><span class=line><span class=cl><span class=na>ExecStart</span><span class=o>=</span><span class=s>/root/unbound-block-hosts/unbound-block-hosts</span>
</span></span></code></pre></div><p><code>systemctl enable block-hosts.timer</code> aktiviert anschließend den Timer, nach dem nächsten Neustart oder
expliziten Start des Timers läuft dieser dann wöchentlich.</p><h2 id=abschließende-gedanken>Abschließende Gedanken</h2><p>Bevor ihr euch sowas aufsetzt solltet ihr euch im Klaren sein, dass ihr einer Industrie schadet indem ihr euch
nichtmehr von ihr melken lasst. Da jedoch seitens der Werbeindustrie jahrelang die Privatsphäre und Sicherheit
der Nutzer ignoriert wurde um sie auszuschlachten fällt mir persönlich diese Entscheidung nicht schwer.
Liebe Werbeindustrie, ihr hattet eure Chance (u.a. mit Do Not Track) und habt sie nicht genutzt. Selbst
Schuld.</p><p>Unabhängig davon wie man zur Werbeindustrie steht sollte man das Einrichten dieses Setup im Netzwerk mit den
Nutzern absprechen. Hierbei handelt es sich auch um eine Form der Zensur, wenn Nutzer Werbung sehen wollen
ist das auch ihr gutes Recht. Zudem kantet man einige &ldquo;legitime&rdquo; Seiten raus, die Adblock-Nutzer blockieren
weil das Geschäftsmodell auf Werbung basiert. Wenn der Besuch solcher Seiten von Nutzern erwünscht wird,
sollte man dies respektieren.</p><p>Da ich auch schon von Abmahnungen für Werbeblocker-Tutorials gehört habe, möchte ich nochmal klarstellen,
dass es sich hierbei um keine Anleitung zum Werbung Blocken handelt. Diese Ideennotiz ist in keinster
Weise vollständig und sowas setzen nur Administratoren auf, die das auch ohne diesen Blogpost tun würden.
Sollte ich trotzdem Post bekommen hat der Absender sich hoffentlich folgende Fragen gestellt und mit &ldquo;Ja&rdquo;</p><p>beantwortet:</p><ul><li>Habe ich Verstanden was hier gemacht wird?</li><li>Was ist DNS, unbound, Linux, ein Raspberry Pi, Github und Perl, was davon habe ich daheim und wie gehe ich
damit um?</li><li>Kann ich/der Ottonormalverbraucher den beschriebenen Setup in einer halben Stunde nachbauen sodass er
funktioniert?</li></ul><p><strong>Update</strong>
Hinweis von Danny Korpan per Mail:</p><blockquote><p>Kleiner Tipp, mit dem wird zwar perl für unbound-block-hosts nicht obsolet, jedoch kann man bei folgender
Blocklist direkt mit wget arbeiten:
<a href="https://pgl.yoyo.org/adservers/serverlist.php?hostformat=unbound&amp;showintro=0&amp;startdate%5Bday%5D=&amp;startdate%5Bmonth%5D=&amp;startdate%5Byear%5D=&amp;mimetype=plaintext">https://pgl.yoyo.org/adservers/serverlist.php?hostformat=unbound&amp;showintro=0&amp;startdate[day]=&amp;startdate[month]=&amp;startdate[year]=&amp;mimetype=plaintext</a>
bzw.
<a href=https://pgl.yoyo.org/adservers/>https://pgl.yoyo.org/adservers/</a></p></blockquote><div class=blog-tags><a href=https://edermi.github.io/tags/werbung/>Werbung</a>&nbsp;
<a href=https://edermi.github.io/tags/unbound/>unbound</a>&nbsp;
<a href=https://edermi.github.io/tags/dns/>DNS</a>&nbsp;</div></article><ul class="pager blog-pager"><li class=previous><a href=https://edermi.github.io/post/2015/zsh-letzten-befehl-als-root/ data-toggle=tooltip data-placement=top title="zsh: letzten Befehl als root ausführen">&larr; Previous Post</a></li><li class=next><a href=https://edermi.github.io/post/2017/praesentieren_mit_markdown/ data-toggle=tooltip data-placement=top title="Präsentationen mit Markdown (oder was auch immer)">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"></ul><p class="credits copyright text-muted">&nbsp;&bull;&nbsp;&copy;
2024
&nbsp;&bull;&nbsp;
<a href=https://edermi.github.io/>edermi's Blog</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.134.1</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a>
&nbsp;&bull;&nbsp;[<a href=https://github.com/edermi/edermi.github.io/tree/6cbbb4311c481e3bbd96b1d169d2aba5168c082c>6cbbb431</a>]</p></div></div></div></footer><script defer src=https://edermi.github.io/js/katex.min.js></script><script defer src=https://edermi.github.io/js/auto-render.min.js onload=renderMathInElement(document.body)></script><script src=https://edermi.github.io/js/jquery-3.7.0.slim.min.js></script><script src=https://edermi.github.io/js/bootstrap.min.js></script><script src=https://edermi.github.io/js/main.js></script><script src=https://edermi.github.io/js/photoswipe.min.js></script><script src=https://edermi.github.io/js/photoswipe-ui-default.min.js></script><script src=https://edermi.github.io/js/load-photoswipe.js></script></body></html>